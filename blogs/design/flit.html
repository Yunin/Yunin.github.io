<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flit 实时模板翻译设计 | Yunin blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Blog">
    
    <link rel="preload" href="/assets/css/0.styles.511a40cd.css" as="style"><link rel="preload" href="/assets/js/app.28467d71.js" as="script"><link rel="preload" href="/assets/js/3.33d7f2db.js" as="script"><link rel="preload" href="/assets/js/1.c1260343.js" as="script"><link rel="preload" href="/assets/js/11.0ec65f7b.js" as="script"><link rel="preload" href="/assets/js/8.3fa24ff3.js" as="script"><link rel="prefetch" href="/assets/js/10.7ec1b5d1.js"><link rel="prefetch" href="/assets/js/12.347b1262.js"><link rel="prefetch" href="/assets/js/13.ae4429db.js"><link rel="prefetch" href="/assets/js/14.a05fd8e2.js"><link rel="prefetch" href="/assets/js/15.01fd7f02.js"><link rel="prefetch" href="/assets/js/4.444d7c9f.js"><link rel="prefetch" href="/assets/js/5.d622ff65.js"><link rel="prefetch" href="/assets/js/6.7d133c20.js"><link rel="prefetch" href="/assets/js/7.d3861278.js"><link rel="prefetch" href="/assets/js/9.b93d2da0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.511a40cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Yunin blog</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>Blog</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Yunin</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Yunin blog" class="logo"> <span class="site-name">Yunin blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Design/" class="nav-link"><i class="undefined"></i>
  Design
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/Tool/" class="nav-link"><i class="undefined"></i>
  Tool
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    Yunin
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>3</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>4</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Design/" class="nav-link"><i class="undefined"></i>
  Design
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/Tool/" class="nav-link"><i class="undefined"></i>
  Tool
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Flit 实时模板翻译设计</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Yunin</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">Flit 实时模板翻译设计</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>Yunin</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>6/1/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>Design</span></i></div></div> <div class="theme-reco-content content__default"><p>[TOC]</p> <h1 id="flit-实时模板翻译设计"><a href="#flit-实时模板翻译设计" class="header-anchor">#</a> Flit 实时模板翻译设计</h1> <ul><li><p>Flit core: 提供机票翻译线上接口</p></li> <li><p>Flit datastream-collection: 房型翻译的数据保存CmongoDB 和推送消息给IBU多语言酒店</p></li> <li><p>Flit for job: 机票job翻译翻译</p></li> <li><p>Flit general trans</p> <ul><li>房型名翻译</li> <li>Ctran内部数据等</li> <li>地址翻译等其他</li></ul></li></ul> <h2 id="flit-core-flight-translation"><a href="#flit-core-flight-translation" class="header-anchor">#</a> flit-core(Flight translation)</h2> <h3 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h3> <p>Flit 主要是提供给机票实时翻译接口，机票翻译的主要是政策类数据，机票退改签和备注。机票调用很多都是重复调用，数据重复，且数据变更的都是一些地点，日期，数字以及金额之类的。</p> <h3 id="流程图"><a href="#流程图" class="header-anchor">#</a> 流程图</h3> <h4 id="整个flit翻译及数据更新"><a href="#整个flit翻译及数据更新" class="header-anchor">#</a> 整个Flit翻译及数据更新</h4> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="394px" preserveAspectRatio="none" version="1.1" viewBox="0 0 344 394" width="344px" zoomAndPan="magnify" style="width:344px;height:394px;"><defs><filter height="300%" id="ffpjxtgr9p2uy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"></feBlend></filter></defs><g><ellipse cx="63" cy="48.6982" fill="#000000" filter="url(#ffpjxtgr9p2uy)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"></ellipse><rect fill="#FEFECE" filter="url(#ffpjxtgr9p2uy)" height="33.9688" rx="12.5" ry="12.5" width="48" x="39" y="132.667" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="49" y="153.8057">内容处理</text><rect fill="#FEFECE" filter="url(#ffpjxtgr9p2uy)" height="33.9688" rx="12.5" ry="12.5" width="48" x="39" y="78.6982" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="49" y="99.8369">翻译服务</text><polygon fill="#FEFECE" filter="url(#ffpjxtgr9p2uy)" points="42,358.5342,84,358.5342,96,370.5342,84,382.5342,42,382.5342,30,370.5342,42,358.5342" style="stroke:#A80036;stroke-width:1.5;"></polygon><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="42" y="374.3423">更新翻译流程</text><line x1="15" x2="15" y1="12.7451" y2="382.5342" style="stroke:#000000;stroke-width:2.0;"></line><rect fill="#FAEBD7" height="369.7891" width="110" x="127" y="12.7451" style="stroke:#FAEBD7;stroke-width:1.0;"></rect><rect fill="#FEFECE" filter="url(#ffpjxtgr9p2uy)" height="33.9688" rx="12.5" ry="12.5" width="48" x="158.5" y="186.6357" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="168.5" y="207.7744">内容收集</text><line x1="127" x2="127" y1="12.7451" y2="382.5342" style="stroke:#000000;stroke-width:2.0;"></line><rect fill="#FEFECE" filter="url(#ffpjxtgr9p2uy)" height="33.9688" rx="12.5" ry="12.5" width="48" x="257" y="250.5967" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="267" y="271.7354">内容统计</text><rect fill="#FEFECE" filter="url(#ffpjxtgr9p2uy)" height="33.9688" rx="12.5" ry="12.5" width="48" x="257" y="304.5654" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="267" y="325.7041">编辑处理</text><line x1="237" x2="237" y1="12.7451" y2="382.5342" style="stroke:#000000;stroke-width:2.0;"></line><line x1="324" x2="324" y1="12.7451" y2="382.5342" style="stroke:#000000;stroke-width:2.0;"></line><line x1="63" x2="63" y1="112.667" y2="132.667" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="59,122.667,63,132.667,67,122.667,63,126.667" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="96" x2="108" y1="370.5342" y2="370.5342" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="104,240.6045,108,230.6045,112,240.6045,108,236.6045" style="stroke:#A80036;stroke-width:1.5;"></polygon><line x1="108" x2="108" y1="95.6826" y2="370.5342" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="108" x2="87" y1="95.6826" y2="95.6826" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="97,91.6826,87,95.6826,97,99.6826,93,95.6826" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="63" x2="63" y1="58.6982" y2="78.6982" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="59,68.6982,63,78.6982,67,68.6982,63,72.6982" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="281" x2="281" y1="284.5654" y2="304.5654" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="277,294.5654,281,304.5654,285,294.5654,281,298.5654" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="63" x2="63" y1="166.6357" y2="171.6357" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="63" x2="182.5" y1="171.6357" y2="171.6357" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="182.5" x2="182.5" y1="171.6357" y2="186.6357" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="178.5,176.6357,182.5,186.6357,186.5,176.6357,182.5,180.6357" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="182.5" x2="182.5" y1="220.6045" y2="233.0967" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="182.5" x2="281" y1="233.0967" y2="233.0967" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="281" x2="281" y1="233.0967" y2="250.5967" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="277,240.5967,281,250.5967,285,240.5967,281,244.5967" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="281" x2="281" y1="338.5342" y2="343.5342" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="281" x2="63" y1="343.5342" y2="343.5342" style="stroke:#A80036;stroke-width:1.5;"></line><line x1="63" x2="63" y1="343.5342" y2="358.5342" style="stroke:#A80036;stroke-width:1.5;"></line><polygon fill="#A80036" points="59,348.5342,63,358.5342,67,348.5342,63,352.5342" style="stroke:#A80036;stroke-width:1.0;"></polygon><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="44" x="49" y="29.4531">机票接口</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="100" x="132" y="29.4531">Pharos(Flit)</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="77" x="242" y="29.4531">Ctran 平台</text></g></svg><h4 id="翻译时序图"><a href="#翻译时序图" class="header-anchor">#</a> 翻译时序图</h4> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="244px" preserveAspectRatio="none" version="1.1" viewBox="0 0 563 244" width="563px" zoomAndPan="magnify" style="width:563px;height:244px;"><defs><filter height="300%" id="f1dv31kbscusqk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"></feBlend></filter></defs><g><line x1="35" x2="35" y1="38.2969" y2="203.9609" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="107.5" x2="107.5" y1="38.2969" y2="203.9609" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="243.5" x2="243.5" y1="38.2969" y2="203.9609" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="419.5" x2="419.5" y1="38.2969" y2="203.9609" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="531.5" x2="531.5" y1="38.2969" y2="203.9609" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="51" x="8" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="15" y="22.9951">请求/响应</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="51" x="8" y="202.9609" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="15" y="222.9561">请求/响应</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="38" x="86.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="93.5" y="22.9951">预处理</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="38" x="86.5" y="202.9609" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="93.5" y="222.9561">预处理</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="46" x="218.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="225.5" y="22.9951">内容处理</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="46" x="218.5" y="202.9609" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="225.5" y="222.9561">内容处理</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="46" x="394.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="401.5" y="22.9951">结果组合</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="46" x="394.5" y="202.9609" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="401.5" y="222.9561">结果组合</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="46" x="506.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="513.5" y="22.9951">内容收集</text><rect fill="#FEFECE" filter="url(#f1dv31kbscusqk)" height="30.2969" width="46" x="506.5" y="202.9609" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="513.5" y="222.9561">内容收集</text><polygon fill="#A80036" points="95.5,65.4297,105.5,69.4297,95.5,73.4297,99.5,69.4297" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="35.5" x2="101.5" y1="69.4297" y2="69.4297" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="42.5" y="64.3638">拆句，格式化</text><polygon fill="#A80036" points="231.5,94.5625,241.5,98.5625,231.5,102.5625,235.5,98.5625" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="107.5" x2="237.5" y1="98.5625" y2="98.5625" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="114.5" y="93.4966">原文或者是模板，获取翻译结果</text><polygon fill="#A80036" points="407.5,123.6953,417.5,127.6953,407.5,131.6953,411.5,127.6953" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="243.5" x2="413.5" y1="127.6953" y2="127.6953" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="250.5" y="122.6294">句子拼接或者变量提取等其他结果后置处理</text><polygon fill="#A80036" points="519.5,152.8281,529.5,156.8281,519.5,160.8281,523.5,156.8281" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="419.5" x2="525.5" y1="156.8281" y2="156.8281" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="426.5" y="151.7622">针对原文和模板翻译收集</text><polygon fill="#A80036" points="46.5,181.9609,36.5,185.9609,46.5,189.9609,42.5,185.9609" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="40.5" x2="530.5" y1="185.9609" y2="185.9609" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="52.5" y="180.895">日志/ES埋点</text></g></svg><h5 id="a-预处理"><a href="#a-预处理" class="header-anchor">#</a> a.预处理</h5> <h6 id="句子拆分"><a href="#句子拆分" class="header-anchor">#</a> 句子拆分</h6> <p>按照规则拆分句子，同时要保护一些情况下不需要拆分，比如英文句号，英文句号可能是数据标点。</p> <h6 id="格式化"><a href="#格式化" class="header-anchor">#</a> 格式化</h6> <p>针对不同的语言情况下，现在就2大类，中文和及其他（其他一般指的是英文）。<br>
中文：空格处理等<br>
英文：多个空格等</p> <h5 id="b-内容处理"><a href="#b-内容处理" class="header-anchor">#</a> b.内容处理</h5> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="360px" preserveAspectRatio="none" version="1.1" viewBox="0 0 386 360" width="386px" zoomAndPan="magnify" style="width:386px;height:360px;"><defs><filter height="300%" id="f1i3inxuccoyub" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"></feBlend></filter></defs><g><line x1="35" x2="35" y1="38.2969" y2="320.4922" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="139.5" x2="139.5" y1="38.2969" y2="320.4922" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="211.5" x2="211.5" y1="38.2969" y2="320.4922" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="271.5" x2="271.5" y1="38.2969" y2="320.4922" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="342.5" x2="342.5" y1="38.2969" y2="320.4922" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="51" x="8" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="15" y="22.9951">原文/译文</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="51" x="8" y="319.4922" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="15" y="339.4873">原文/译文</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="46" x="114.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="121.5" y="22.9951">本地缓存</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="46" x="114.5" y="319.4922" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="121.5" y="339.4873">本地缓存</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="46" x="186.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="193.5" y="22.9951">变量识别</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="46" x="186.5" y="319.4922" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="193.5" y="339.4873">变量识别</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="46" x="246.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="253.5" y="22.9951">变量翻译</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="46" x="246.5" y="319.4922" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="253.5" y="339.4873">变量翻译</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="69" x="306.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="313.5" y="22.9951">Redis缓存</text><rect fill="#FEFECE" filter="url(#f1i3inxuccoyub)" height="30.2969" width="69" x="306.5" y="319.4922" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="313.5" y="339.4873">Redis缓存</text><polygon fill="#A80036" points="127.5,65.4297,137.5,69.4297,127.5,73.4297,131.5,69.4297" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="35.5" x2="133.5" y1="69.4297" y2="69.4297" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="42.5" y="64.3638">请求原文直接本地缓存</text><polygon fill="#A80036" points="46.5,94.5625,36.5,98.5625,46.5,102.5625,42.5,98.5625" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="40.5" x2="138.5" y1="98.5625" y2="98.5625" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="52.5" y="93.4966">存在则返回</text><polygon fill="#A80036" points="199.5,123.6953,209.5,127.6953,199.5,131.6953,203.5,127.6953" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="139.5" x2="205.5" y1="127.6953" y2="127.6953" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="146.5" y="122.6294">原文模板化</text><polygon fill="#A80036" points="150.5,152.8281,140.5,156.8281,150.5,160.8281,146.5,156.8281" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="144.5" x2="210.5" y1="156.8281" y2="156.8281" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="156.5" y="151.7622">模板是否存在</text><polygon fill="#A80036" points="259.5,181.9609,269.5,185.9609,259.5,189.9609,263.5,185.9609" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="139.5" x2="265.5" y1="185.9609" y2="185.9609" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="146.5" y="180.895">模板存在，变量对应转化</text><polygon fill="#A80036" points="46.5,211.0938,36.5,215.0938,46.5,219.0938,42.5,215.0938" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="40.5" x2="270.5" y1="215.0938" y2="215.0938" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="52.5" y="210.0278">存在则返回</text><polygon fill="#A80036" points="331,240.2266,341,244.2266,331,248.2266,335,244.2266" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="139.5" x2="337" y1="244.2266" y2="244.2266" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="146.5" y="239.1606">查询Redis缓存</text><polygon fill="#A80036" points="282.5,269.3594,272.5,273.3594,282.5,277.3594,278.5,273.3594" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="276.5" x2="342" y1="273.3594" y2="273.3594" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="288.5" y="268.2935">返回结果</text><polygon fill="#A80036" points="46.5,298.4922,36.5,302.4922,46.5,306.4922,42.5,302.4922" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="40.5" x2="270.5" y1="302.4922" y2="302.4922" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="52.5" y="297.4263">存在则返回</text></g></svg><h6 id="i-本地缓存"><a href="#i-本地缓存" class="header-anchor">#</a> i. 本地缓存</h6> <p>原文请求等是被动缓存，原文请求会被动缓存下来，过期时间短。</p> <p>配置模板第是主动缓存，程序启动初始化，后面增量更新指本地缓存。</p> <h6 id="ii-redis-缓存"><a href="#ii-redis-缓存" class="header-anchor">#</a> ii. Redis 缓存</h6> <p>​	Flit有专门的job全量/增量写入redis.</p> <h6 id="iii-变量识别"><a href="#iii-变量识别" class="header-anchor">#</a> iii. 变量识别</h6> <ul><li>数字</li> <li>日期</li> <li>城市/机场三字码</li> <li>币种</li></ul> <p>数字，日期和币种都是结构化数据，可以通过正则识别。</p> <p>城市/机场三字码是通过双数组数据结构，进行识别。</p> <p>机票翻译接入了很多类型，每种类型配置了不同的变量识别。</p> <h6 id="iv-变量翻译"><a href="#iv-变量翻译" class="header-anchor">#</a> iv.变量翻译</h6> <p>数字，币种可以转化为一个钟通用的格式。</p> <p>日期通过引入shark组件本地化</p> <p>城市/机场三字码，依赖是编辑翻译，可以理解有一张配置表。</p> <h5 id="c-内容组合"><a href="#c-内容组合" class="header-anchor">#</a> c.内容组合</h5> <p>翻译是基于句子去翻译的，请求的内容可能是多个句子，每种语言的句子结尾都不一样。处理也是不一样。<br>
另外不同的要求，有些需要对翻译内容，提取一些变量，比如机票需要提取币种。<br>
根据定义的契约，组合对应的响应。</p> <h5 id="d-内容收集"><a href="#d-内容收集" class="header-anchor">#</a> d.内容收集</h5> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="185px" preserveAspectRatio="none" version="1.1" viewBox="0 0 558 185" width="558px" zoomAndPan="magnify" style="width:558px;height:185px;"><defs><filter height="300%" id="frpgw14dsj20r" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"></feBlend></filter></defs><g><line x1="33" x2="33" y1="38.2969" y2="145.6953" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="161" x2="161" y1="38.2969" y2="145.6953" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="376.5" x2="376.5" y1="38.2969" y2="145.6953" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><line x1="515.5" x2="515.5" y1="38.2969" y2="145.6953" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;"></line><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="46" x="8" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="15" y="22.9951">翻译信息</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="46" x="8" y="144.6953" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="15" y="164.6904">翻译信息</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="30" x="144" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="16" x="151" y="22.9951">消息</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="30" x="144" y="144.6953" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="16" x="151" y="164.6904">消息</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="69" x="340.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="347.5" y="22.9951">Spark统计</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="69" x="340.5" y="144.6953" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="347.5" y="164.6904">Spark统计</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="67" x="480.5" y="3" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="487.5" y="22.9951">推送Ctran</text><rect fill="#FEFECE" filter="url(#frpgw14dsj20r)" height="30.2969" width="67" x="480.5" y="144.6953" style="stroke:#A80036;stroke-width:1.5;"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="487.5" y="164.6904">推送Ctran</text><polygon fill="#A80036" points="149,65.4297,159,69.4297,149,73.4297,153,69.4297" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="33" x2="155" y1="69.4297" y2="69.4297" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="40" y="64.3638">原文，译文，翻译状态等信息</text><polygon fill="#A80036" points="365,94.5625,375,98.5625,365,102.5625,369,98.5625" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="161" x2="371" y1="98.5625" y2="98.5625" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="168" y="93.4966">按照类型，原文等维度，设置一定时间窗口，归集数据</text><polygon fill="#A80036" points="504,123.6953,514,127.6953,504,131.6953,508,127.6953" style="stroke:#A80036;stroke-width:1.0;"></polygon><line x1="377" x2="510" y1="127.6953" y2="127.6953" style="stroke:#A80036;stroke-width:1.0;"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="384" y="122.6294">形成统计数据，落地到Ctran</text></g></svg><h2 id="flit-模板实时交互图"><a href="#flit-模板实时交互图" class="header-anchor">#</a> Flit 模板实时交互图</h2> <p><img src="/assets/img/image-20210512143312472.68296dfa.png" alt="image-20210512143312472"></p> <ol><li>步骤1~2 是同步的，发送请求，同步获取响应，完成Flit在线实时模板翻译。</li> <li>步骤3~5 是异步进行的，通过QMQ解耦。</li> <li>步骤3，收集Flit 请求与响应，同步Muise平台归集Flit数据。</li> <li>步骤4，Muise归集好的Flit数据，通过QMQ传入Ctran平台。</li> <li>步骤5，编辑/运营人员根据Ctran归集好的数据，处理未翻译模板数据。</li></ol> <h2 id="flit-缓存策略"><a href="#flit-缓存策略" class="header-anchor">#</a> Flit 缓存策略</h2> <p><img src="/assets/img/image-20210512143401039.15813ee5.png" alt="image-20210512143401039"></p> <p>应用初始化，loading 模板至本地缓存（大概只在100M 左右）。</p> <ol><li>原文缓存是被动缓存，请求结果/响应存入caffeine，设置好大小以及过期策略。</li> <li>模板缓存，主动缓存+查询被动缓存。首次的时候，全量同步DB数据至本地缓存，剩下就是查询后异步去redis同步至本地。好处就是：所有请求都走本地，异步校验模板存在问题。</li> <li>Redis缓存只是作为中间查询使用，不是强依赖。</li> <li>DB数据变更，主动触发Redis和本地缓存一致性。</li></ol></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/2/2021, 7:04:54 AM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/blogs/design/flit.html#flit-core-flight-translation" class="sidebar-link reco-side-flit-core-flight-translation" data-v-70334359>flit-core(Flight translation)</a></li><li class="level-3" data-v-70334359><a href="/blogs/design/flit.html#背景" class="sidebar-link reco-side-背景" data-v-70334359>背景</a></li><li class="level-3" data-v-70334359><a href="/blogs/design/flit.html#流程图" class="sidebar-link reco-side-流程图" data-v-70334359>流程图</a></li><li class="level-2" data-v-70334359><a href="/blogs/design/flit.html#flit-模板实时交互图" class="sidebar-link reco-side-flit-模板实时交互图" data-v-70334359>Flit 模板实时交互图</a></li><li class="level-2" data-v-70334359><a href="/blogs/design/flit.html#flit-缓存策略" class="sidebar-link reco-side-flit-缓存策略" data-v-70334359>Flit 缓存策略</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><!----><div></div><!----><!----></div></div>
    <script src="/assets/js/app.28467d71.js" defer></script><script src="/assets/js/3.33d7f2db.js" defer></script><script src="/assets/js/1.c1260343.js" defer></script><script src="/assets/js/11.0ec65f7b.js" defer></script><script src="/assets/js/8.3fa24ff3.js" defer></script>
  </body>
</html>
